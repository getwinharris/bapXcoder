<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bapXcoder Architecture - Dual-Model AI System with Persistent Memory</title>
    <meta name="description" content="Deep dive into bapXcoder's dual-model architecture with internal interpreter/developer split and project-based memory." />
    <meta name="keywords" content="bapXcoder architecture, dual-model system, interpreter developer split, persistent memory, project context" />
    <link rel="canonical" href="https://docs.coder.bapx.in/architecture.html" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f0f13 0%, #1a1a25 100%);
            color: #e0e0e0;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            padding: 30px 0;
            text-align: center;
            border-bottom: 1px solid rgba(124, 92, 255, 0.2);
        }
        
        .logo {
            font-size: 2.5rem;
            color: #7c5cff;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            color: #7c5cff;
        }
        
        .subtitle {
            color: #a0a0c0;
            font-size: 1.2rem;
            margin-bottom: 30px;
        }
        
        .content {
            max-width: 800px;
            margin: 0 auto;
            padding: 30px 0;
        }
        
        h2 {
            color: #7c5cff;
            margin: 30px 0 15px 0;
            font-size: 1.5rem;
        }
        
        h3 {
            color: #50fa7b;
            margin: 20px 0 10px 0;
            font-size: 1.3rem;
        }
        
        .architecture-section {
            background: linear-gradient(180deg, #161622 0%, #14141c 100%);
            border: 1px solid #2d2d40;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
        }
        
        .component-diagram {
            background: rgba(124, 92, 255, 0.1);
            border-left: 4px solid #7c5cff;
            padding: 20px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            white-space: pre;
            overflow-x: auto;
        }
        
        .security-metric {
            background: rgba(80, 250, 123, 0.1);
            border: 1px solid #50fa7b;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .model-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: #161622;
            border: 1px solid #2d2d40;
            border-radius: 8px;
        }
        
        .model-table th, .model-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #2d2d40;
        }
        
        .model-table th {
            background: rgba(124, 92, 255, 0.2);
            color: #7c5cff;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .feature-card {
            background: rgba(80, 250, 123, 0.05);
            border: 1px solid #2d2d40;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }
        
        .feature-card h4 {
            color: #50fa7b;
            margin-bottom: 10px;
        }
        
        .nav-links {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: rgba(124, 92, 255, 0.1);
            border-radius: 8px;
        }
        
        .nav-links a {
            color: #7c5cff;
            text-decoration: none;
            margin: 0 10px;
            padding: 8px 16px;
            border-radius: 6px;
            background: rgba(124, 92, 255, 0.2);
        }
        
        .nav-links a:hover {
            background: rgba(124, 92, 255, 0.3);
        }
        
        footer {
            margin-top: 50px;
            padding: 30px 0;
            text-align: center;
            border-top: 1px solid rgba(124, 92, 255, 0.2);
            color: #a0a0c0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">⬡ bapXcoder</div>
            <h1>Architecture Deep Dive</h1>
            <p class="subtitle">Dual-model AI system with persistent project memory and deterministic behavior</p>
        </header>
        
        <main class="content">
            <h2>Core Architecture Overview</h2>
            <p>bapXcoder implements a sophisticated single-agent architecture with dual-internal functions, designed to provide both specialized capabilities and deterministic behavior. Unlike multi-agent systems that risk context drift, bapXcoder maintains consistent context through a unified agent with role separation.</p>
            
            <div class="architecture-section">
                <h3>Single Agent with Dual Functions</h3>
                
                <p>The bapXcoder IDE Agent operates with two specialized internal functions:</p>
                
                <div class="feature-grid">
                    <div class="feature-card">
                        <h4>Interpreter Function</h4>
                        <p>Handles all user communication, multimodal processing, and context management</p>
                    </div>
                    
                    <div class="feature-card">
                        <h4>Developer Function</h4>
                        <p>Executes specialized coding tasks and follows structured instructions only</p>
                    </div>
                </div>
                
                <p>Both functions share the same project memory and session state for consistency.</p>
            </div>
            
            <h2>Model Connection Architecture</h2>
            
            <div class="architecture-section">
                <h3>Runtime-Based Model Access via llama.cpp</h3>
                
                <p>bapXcoder connects to Hugging Face models via llama.cpp runtime without local storage:</p>
                
                <div class="component-diagram">
┌─────────────────┐    ┌──────────────────────────────────────┐    ┌─────────────────┐
│   bapXcoder    │    │         llama.cpp Runtime            │    │  Hugging Face  │
│    Interface   │───▶│  (Direct Model Access via API)      │───▶│    Models      │
│                │    │  ┌─────────────────────────────────┐  │    │                │
│ (User Space)   │    │  │  Interpreter Model (Qwen3-VL)  │  │    │  ┌──────────┐  │
│                │    │  │  - Communication               │  │    │  │Qwen3-VL  │  │
│                │    │  │  - Context Management          │  │    │  │Model     │  │
│                │    │  │  - Multimodal Processing       │  │    │  └──────────┘  │
│                │    │  └─────────────────────────────────┤  │    │                │
│                │    │  ┌─────────────────────────────────┤  │    │  ┌──────────┐  │
│                │    │  │  Developer Model (Qwen3-Coder) │  │    │  │Qwen3-    │  │
│                │    │  │  - Code Generation             │  │    │  │Coder Model│  │
│                │    │  │  - Implementation Tasks        │  │    │  └──────────┘  │
│                │    │  │  - Code Analysis               │  │    │                │
└─────────────────┘    │  └─────────────────────────────────┘  │    └─────────────────┘
                       │         (No Local Storage)            │
                       └─────────────────────────────────────────┘
                </div>
            </div>
            
            <h2>Dual-Function Internal Architecture</h2>
            
            <div class="architecture-section">
                <h3>Function Specialization and Coordination</h3>
                
                <table class="model-table">
                    <thead>
                        <tr>
                            <th>Function</th>
                            <th>Responsibilities</th>
                            <th>Communication Rights</th>
                            <th>Access Level</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Interpreter</strong></td>
                            <td>
                                <ul>
                                    <li>All user interaction and communication</li>
                                    <li>Context management and session continuity</li>
                                    <li>Multimodal processing (OCR, images, voice)</li>
                                    <li>Coordination with Developer function</li>
                                    <li>Project memory management</li>
                                    <li>File operation validation and mediation</li>
                                </ul>
                            </td>
                            <td>Direct communication with users</td>
                            <td>Full project access</td>
                        </tr>
                        <tr>
                            <td><strong>Developer</strong></td>
                            <td>
                                <ul>
                                    <li>Coding task execution only</li>
                                    <li>Code generation and implementation</li>
                                    <li>Code analysis and refactoring</li>
                                    <li>Following structured instructions from Interpreter</li>
                                    <li>Security and validation checks</li>
                                    <li>Repository-level coding understanding</li>
                                </ul>
                            </td>
                            <td>Only internal communication with Interpreter</td>
                            <td>Only executes authorized changes</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <h2>Project Memory Architecture</h2>
            
            <div class="architecture-section">
                <h3>Persistent Session Memory System</h3>
                
                <p>Each project maintains its own persistent memory with user isolation:</p>
                
                <div class="component-diagram">
project-root/
└── .bapXcoder/
    └── users/
        └── {user_id}/
            ├── sessiontree.json    # Session state and memory (continuity system)
            ├── todo.json          # User intent and task tracking (intent system) 
            ├── validation_log.json # AI-driven testing results and validation history
            └── session_key.enc    # Unique encryption key per user
                </div>
                
                <h4>Memory File Specifications</h4>
                
                <div class="security-metric">
                    <h4>sessiontree.json - Session Continuity</h4>
                    <p>Contains: last_task, last_action, session_state, active_files, user_context, timestamp</p>
                    <p>Used for: Restoring user context on IDE startup</p>
                </div>
                
                <div class="security-metric">
                    <h4>todo.json - User Intent Tracking</h4>
                    <p>Contains: pending_tasks, completed_tasks, priorities, categories, timestamps</p>
                    <p>Used for: Maintaining user's development intentions and task tracking</p>
                </div>
            </div>
            
            <h2>Session Continuity Protocol</h2>
            
            <div class="architecture-section">
                <h3>Context Restoration Process</h3>
                
                <p>On IDE startup, bapXcoder follows this continuity protocol:</p>
                
                <ol>
                    <li><strong>Authentication Check</strong>: Verify user identity via GitHub/Google OAuth</li>
                    <li><strong>Memory File Check</strong>: Locate sessiontree.json and todo.json in user directory</li>
                    <li><strong>Context Extraction</strong>: Read last activities and pending tasks</li>
                    <li><strong>Message Construction</strong>: Build continuity message: "System resumed. You were working on X. Last action was Y. Pending tasks: Z."</li>
                    <li><strong>Context Restoration</strong>: Load user context and project state</li>
                    <li><strong>Ready State</strong>: IDE operational with full context restored</li>
                </ol>
                
                <div class="component-diagram">
Startup Process:
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   IDE Start     │───▶│  Auth Check     │───▶│ Memory Load     │
└─────────────────┘    └─────────────────┘    └─────────────────┘
                            │                       │
                            ▼                       ▼
                    ┌─────────────────┐    ┌─────────────────┐
                    │  User Context   │    │  Continuity     │
                    │  Verification   │    │  Message:       │
                    └─────────────────┘    │ "System resumed │
                            │              │  You were       │
                            ▼              │  working on X.  │
                    ┌─────────────────┐    │  Last action Y. │
                    │  Session Data   │    │  Pending Z."    │
                    │  Restored       │    └─────────────────┘
                    └─────────────────┘
                            │
                            ▼
                    ┌─────────────────┐
                    │    Ready        │
                    │  For Operation  │
                    └─────────────────┘
                </div>
            </div>
            
            <h2>Security Architecture</h2>
            
            <div class="architecture-section">
                <h3>Role-Based Safety and Determinism</h3>
                
                <p>The architecture includes multiple safety layers:</p>
                
                <div class="security-metric">
                    <h4>Safety Layer 1: Role Isolation</h4>
                    <p>Developer function cannot communicate directly with users, preventing unauthorized actions</p>
                </div>
                
                <div class="security-metric">
                    <h4>Safety Layer 2: Approval Workflow</h4>
                    <p>All file changes require user approval through diff visualization</p>
                </div>
                
                <div class="security-metric">
                    <h4>Safety Layer 3: Boundary Enforcement</h4>
                    <p>All operations constrained to project directory to prevent system-wide access</p>
                </div>
                
                <div class="security-metric">
                    <h4>Safety Layer 4: Context Consistency</h4>
                    <p>Single agent prevents context drift between different model responses</p>
                </div>
                
                <p>Communication flow: User → Interpreter → (validation) → (if needed) → Developer → (validation) → Interpreter → User Output</p>
            </div>
            
            <h2>Model Interaction Protocol</h2>
            
            <div class="architecture-section">
                <h3>Internal Function Communication</h3>
                
                <p>When a coding task is required, the following protocol is followed:</p>
                
                <ol>
                    <li><strong>User Request</strong>: User submits request to Interpreter function</li>
                    <li><strong>Request Analysis</strong>: Interpreter analyzes request and project context</li>
                    <li><strong>Task Classification</strong>: Determines if coding task requires Developer function</li>
                    <li><strong>Instruction Formation</strong>: Interpreter creates structured, safe instructions for Developer</li>
                    <li><strong>Developer Execution</strong>: Developer executes only the structured instructions</li>
                    <li><strong>Output Validation</strong>: Interpreter validates Developer's output for safety</li>
                    <li><strong>Response Delivery</strong>: Interpreter delivers final response to user</li>
                    <li><strong>Memory Update</strong>: Interpreter updates session memory with new state</li>
                </ol>
                
                <p>This ensures deterministic and safe behavior while maintaining specialized capabilities.</p>
            </div>
            
            <h2>Licensing Architecture</h2>
            
            <div class="architecture-section">
                <h3>Subscription and Access Control System</h3>
                
                <p>Access control is managed through:</p>
                
                <ul>
                    <li><strong>OAuth Integration</strong>: GitHub/Google authentication for secure user verification</li>
                    <li><strong>Local Subscription Storage</strong>: Encrypted subscription data in user's GitHub repositories</li>
                    <li><strong>License Validation</strong>: Runtime validation of subscription status and license limits</li>
                    <li><strong>Dual-Tier Access</strong>: Trial (60 days) and subscription (30-day/$1) tiers</li>
                    <li><strong>Quota Management</strong>: Runtime-based model access using allocated quotas</li>
                </ul>
                
                <p>Subscription data is stored encrypted in user's GitHub repositories, not on bapXcoder servers, ensuring privacy and secure access control.</p>
            </div>
            
            <div class="nav-links">
                <a href="index.html">← Documentation Home</a>
                <a href="getting_started.html">← Previous: Getting Started</a>
                <a href="memory.html">Next: Project Memory →</a>
            </div>
            
            <h2>Frequently Asked Questions</h2>
            
            <div class="faq-item">
                <div class="problem-header">Q: Why use dual-functions instead of two separate models?</div>
                <p>A: Dual-functions within a single agent prevents context drift, maintains consistent responses, and ensures deterministic behavior with shared memory.</p>
            </div>
            
            <div class="faq-item">
                <div class="problem-header">Q: How does the architecture ensure session continuity?</div>
                <p>A: The Interpreter function maintains all session state and project memory in .bapXcoder directories, ensuring consistent context across IDE restarts.</p>
            </div>
            
            <div class="faq-item">
                <div class="problem-header">Q: What prevents the Developer function from bypassing safety checks?</div>
                <p>A: The Developer function only executes structured instructions from the Interpreter and cannot communicate directly with users.</p>
            </div>
            
            <div class="faq-item">
                <div class="problem-header">Q: How is security maintained in the dual-function architecture?</div>
                <p>A: Multiple safety layers: role isolation, approval workflow, boundary enforcement, and communication mediation by the Interpreter function.</p>
            </div>
            
            <div class="faq-item">
                <div class="problem-header">Q: Does the architecture prevent hallucinations?</div>
                <p>A: Yes, the deterministic pipeline and Interpreter-mediated communication prevents hallucinations by maintaining authoritative context.</p>
            </div>
        </main>
        
        <footer>
            <p>© 2025 bapXcoder Architecture Documentation. All rights reserved.</p>
            <p>Part of the bapX Media Hub ecosystem - Advanced Architecture Design.</p>
        </footer>
    </div>
</body>
</html>